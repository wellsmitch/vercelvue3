"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[371],{17378:function(Te,T,t){t.r(T),t.d(T,{default:function(){return ne}});var N=t(43953),B=t.n(N),z=t(2927),j=t.n(z),G=t(39346),c=t.n(G),I=t(91184),R=t.n(I),K=t(9083),f=t.n(K),U=t(54366),m=t(39495),V=t(1550),J=t(1193),Q=t(93134),L=t(69641),W=t(19195),X=t(98958),Y=t(87477),k=t(45839),$=t(4434),q=t(45401),_=t(45416),d=t(38497),Z=t(4701),ee=t(40371),je=t(46185),te=t(38112),s=t(96469),Re=V.Z.Link,oe=(0,m.proxy)({count:0}),ae=function(){var $e=(0,m.useSnapshot)(oe),se=(0,m.useModel)("global"),Ze=se.name,re=(0,d.useState)({count:0,results:[]}),H=f()(re,2),r=H[0],C=H[1],le=(0,d.useState)({current:1,pageSize:5}),M=f()(le,2),h=M[0],ce=M[1],ue=(0,m.useSearchParams)(),ie=f()(ue,1),g=ie[0];console.log("searchMap",g);var de=(0,d.useState)(g.get("code")||""),F=f()(de,2),me=F[0],ve=F[1],pe=function(){var a=R()(B()().mark(function l(o){var n,u,e,i,v;return B()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return n=A,u=g.get("code"),S.next=4,Z.d.k.getListindexData("",{params:{count:1,skip:(h.current-1)*h.pageSize,limit:h.pageSize,where:{$and:[u?{moduleType:{$regex:u,$options:"i"}}:null],$or:[n?{moduleType:{$regex:n,$options:"i"}}:{},n?{content:{$regex:n,$options:"i"}}:{}]}}});case 4:e=S.sent,i="$_$_$",e.results.map(function(p){var x=(p.content||"")&&p.content.replace(/<pre/ig,i+"<pre").replace(/<\/pre>/ig,"</pre>"+i).split(i);x=(p.content||"")&&p.content.replace(/<code/ig,i+"<code").replace(/<\/code>/ig,"</code>"+i).split(i),x=(p.content||"")&&p.content.replace(/<div class=\"ql-code-block-container\"/ig,i+'<div class="ql-code-block-container"').split(i);var Ce=x&&x.map(function(y){var xe={type:y.indexOf("<pre")>-1||y.indexOf("<code")>-1||y.indexOf('<div class="ql-code-block-container"')>-1?"code":"string",val:y};return xe}).filter(function(y){return y.val})||[];p.contentList=Ce}),v=c()(c()({},r),{},{count:e.count,results:o?e.results:[].concat(j()(r.results),j()(e.results))}),C(v);case 9:case"end":return S.stop()}},l)}));return function(o){return a.apply(this,arguments)}}(),A=(0,m.useSelector)(function(a){return a.keywordns.keyword}),P=(0,m.useSelector)(function(a){return a.keywordns.randomId});(0,d.useEffect)(function(){pe(!!P)},[h,A,P,g]);var He=new te.Z(.1).add(.2).valueOf(),fe=J.Z.useForm(),he=f()(fe,1),Me=he[0],b=(0,d.useRef)([]),ge=function(l){var o=E.find(function(n){return n.code===l});return o&&o.name||""};(0,d.useEffect)(function(){var a,l=r==null||(a=r.results)===null||a===void 0?void 0:a.map(function(o){return o.isInitFlag=!0,o}).forEach(function(o,n){return new IntersectionObserver(function(u){u.forEach(function(e){e.intersectionRatio>0?e.rootBounds&&e.boundingClientRect&&e.boundingClientRect.bottom-e.rootBounds.bottom>0?(console.log("111111",111111,n),o.domShowByBottom=!0,o.domHideByBottom=!0,o.domHideByTop=!1,o.domShowByTop=!1,r.results[n]=c()(c()({},r.results[n]),{},{domShowByBottom:!0,domHideByBottom:!0,domHideByTop:!1,domShowByTop:!1}),C(c()({},r))):e.rootBounds&&e.boundingClientRect&&e.boundingClientRect.top-e.rootBounds.top<0:e.rootBounds&&e.boundingClientRect&&e.boundingClientRect.bottom-e.rootBounds.bottom>0?(o.domShowByBottom=!1,o.domHideByBottom=!0,o.domHideByTop=!1,o.domShowByTop=!1,r.results[n]=c()(c()({},r.results[n]),{},{domShowByBottom:!1,domHideByBottom:!0,domHideByTop:!1,domShowByTop:!1}),C(c()({},r))):e.rootBounds&&e.boundingClientRect&&e.boundingClientRect.top-e.rootBounds.top<0})},{}).observe(b.current[n]),o})},[r.results]);var ye=(0,d.useState)([]),D=f()(ye,2),E=D[0],Se=D[1],Be=function(){var a=R()(B()().mark(function l(){var o;return B()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Z.d.k.getCodeListData("",{params:{where:{}}});case 2:o=u.sent,Se(o.results.map(function(e){return c()(c()({},e),{},{code:"".concat(e.code)})}));case 4:case"end":return u.stop()}},l)}));return function(){return a.apply(this,arguments)}}();(0,d.useEffect)(function(){g.get("code")&&Be()},[]);var O=g.get("code");return(0,s.jsx)(U._z,{ghost:!1,children:(0,s.jsxs)(Q.Z,{children:[O&&(0,s.jsx)(L.Z,{span:3,children:(0,s.jsx)(W.Z,{activeKey:me,style:{height:"60vh",position:"sticky",top:"112px"},tabPosition:"left",onChange:function(l){ve(l),C({count:0,results:[]}),m.history.replace({pathname:"/home",search:"?".concat(new URLSearchParams({code:l.split("-")[0]}))})},items:E.map(function(a){return{label:"".concat(a.name),key:"".concat(a.code)}})})}),(0,s.jsxs)(L.Z,{span:O?20:23,offset:1,children:[(0,s.jsx)(X.Z.Compact,{block:!0,className:"indexHome",direction:"vertical",children:r.results.map(function(a,l){return(0,s.jsx)(Y.Z,{ref:function(n){b.current[l]=n},className:"index-card list-panel-hide-bottom "+(a.domShowByBottom||l==0?"list-panel-show-bottom":""),title:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"index-card-title-category",children:ge(a.moduleType)}),"   ",(0,s.jsx)("span",{children:a.title})]}),children:a.contentList.map(function(o,n){return o.type==="string"?(0,s.jsx)("div",{dangerouslySetInnerHTML:{__html:o.val}},"d-"+l+n):(0,s.jsxs)("div",{className:"code-wrap-panel",children:[(0,s.jsx)(ee.Z,{onClick:function(){var e=document.createElement("div");e.innerHTML=o.val,document.body.append(e);var i=e.querySelector(".ql-ui");i&&i.remove();var v=document.createElement("textarea");v.innerText=e.innerText,document.body.append(v),v.select();var w=document.execCommand("copy");k.ZP.success({message:"\u590D\u5236\u6210\u529F\uFF01"+w}),v.remove(),e.remove()},className:"code-wrap-copy-icon"}),(0,s.jsx)("div",{style:{whiteSpace:"pre-wrap"},dangerouslySetInnerHTML:{__html:o.val}})]},"c"+l+n)})},"a"+l)})}),r.results.length<r.count&&r.count>0&&(0,s.jsx)($.Z,{vertical:!0,gap:"small",style:{width:"100%"},children:(0,s.jsx)(q.ZP,{block:!0,onClick:function(){ce(c()(c()({},h),{},{current:h.current+1}))},children:"\u52A0\u8F7D\u66F4\u591A"})}),r.count==0&&(0,s.jsx)($.Z,{vertical:!0,gap:"small",style:{width:"100%"},children:(0,s.jsx)(_.Z,{style:{lineHeight:"32px"},showIcon:!0,type:"info",message:"\u535A\u4E3B\u6B63\u5728\u5B66\u4E60\u6574\u7406\u4E2D\u656C\u8BF7\u671F\u5F85\u5427~"})})]})]})})},ne=ae}}]);
