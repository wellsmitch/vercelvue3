"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[581],{61513:function(q,F,t){t.r(F),t.d(F,{default:function(){return de}});var M=t(43953),d=t.n(M),K=t(91184),u=t.n(K),k=t(39346),i=t.n(k),j=t(2927),S=t.n(j),C=t(9083),b=t.n(C),L=t(4701),W=t(90908),R=t(39495),N=t(60958),D=t(1193),T=t(45401),I=t(98958),A=t(10145),x=t(99836),U=t(37823),c=t(67669),o=t(35170),s=t(58251),e=t(50125),r=t(38497),n=t(18879),v=t(30606),a=t(96469),P=N.Z.Option,B=function(){var ce=D.Z.useForm(),me=b()(ce,1),G=me[0],ee=(0,R.useModel)("@@initialState"),Z=ee.initialState,pe=ee.setInitialState,fe=(0,r.useState)(!1),te=b()(fe,2),ne=te[0],H=te[1],ve=(0,r.useState)({}),ae=b()(ve,2),xe=ae[0],he=ae[1],ge=(0,r.useState)([]),re=b()(ge,2),se=re[0],ye=re[1],De=(0,r.useState)({}),ue=b()(De,2),_=ue[0],V=ue[1],oe=function(){Q(!1),G.resetFields(),H(!1),V({})};(0,r.useEffect)(function(){L.d.k.getCodeListData("").then(function(m){ye((m==null?void 0:m.results)||[])})},[ne]);var $=(0,r.useRef)(),J=(0,r.useRef)(null),ie=(0,r.useRef)(null),je=(0,r.useState)(!1),le=b()(je,2),Ce=le[0],Q=le[1];return(0,r.useEffect)(function(){},[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(W.Z,{actionRef:$,rowKey:function(p){return"key"+p.keyyy},search:{defaultFormItemsNumber:1,submitterColSpanProps:{span:12,flex:1},optionRender:function(p,l,f){return[(0,a.jsx)(T.ZP,{icon:(0,a.jsx)(v.Z,{}),onClick:function(){H(!0),V({})},children:"\u65B0\u589E"},"aa"),(0,a.jsxs)(T.ZP,{onClick:function(){pe(i()(i()({},Z),{},{menuRenderFlag:!(Z!=null&&Z.menuRenderFlag)}))},children:["\u4FA7\u8FB9\u83DC\u5355",Z!=null&&Z.menuRenderFlag?"\u663E\u793A":"\u9690\u85CF"]},"bb")].concat(S()(f))}},columns:[{key:"title",title:"\u6807\u9898",width:260,dataIndex:"title"},{key:"moduleType",title:"\u7C7B\u578B",width:100,dataIndex:"moduleType",render:function(p,l,f,y,h){var E=se.find(function(g){return g.code===l.moduleType});return E&&E.name}},{key:"content",title:"\u5185\u5BB9",dataIndex:"content",ellipsis:!0},{key:"",title:"\u64CD\u4F5C",width:160,align:"center",dataIndex:"action",search:!1,render:function(p,l){return(0,a.jsxs)(I.Z,{children:[(0,a.jsx)(T.ZP,{type:"link",onClick:function(){console.log(l),H(!0),he(l),G.setFieldsValue(l),V(i()({},l))},children:"\u7F16\u8F91"}),(0,a.jsx)(T.ZP,{type:"link",danger:!0,onClick:function(){A.Z.confirm({title:"\u786E\u8BA4\u5220\u9664\u4E48\uFF1F",content:(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(x.Z,{ref:ie})}),onOk:function(){var h,E=(h=ie.current)===null||h===void 0||(h=h.input)===null||h===void 0?void 0:h.value;L.d.k.deleteListindexData("".concat(l.objectId)).then(function(g){if((g==null?void 0:g.code)==null){var O;U.ZP.success({content:"\u5220\u9664\u6210\u529F\uFF01"}),$==null||(O=$.current)===null||O===void 0||O.reload()}})}})},children:"\u5220\u9664"})]})}}],pagination:{showSizeChanger:!0},request:function(){var m=u()(d()().mark(function p(l,f,y){var h;return d()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return console.log("********",l,f,y),g.next=3,L.d.k.getListindexData("",{params:{skip:(l.current-1)*l.pageSize,limit:l.pageSize,order:"-createdAt",count:1,where:{$or:[{title:{$regex:(l==null?void 0:l.title)||"",$options:"i"}}]}}});case 3:return h=g.sent,h.results.map(function(O){O.keyyy=O.objectId+Math.random()}),g.abrupt("return",{data:h.results,success:!0,total:h.count||0});case 6:case"end":return g.stop()}},p)}));return function(p,l,f){return m.apply(this,arguments)}}()}),(0,a.jsx)(A.Z,{okText:(0,a.jsx)(T.ZP,{type:"primary",loading:Ce,onClick:u()(d()().mark(function m(){var p,l,f,y,h,E,g,O,Le,X,z,Y;return d()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(l=G.validateFields(),l){w.next=3;break}return w.abrupt("return");case 3:return Q(!0),f=(p=J.current)===null||p===void 0||(p=p.unprivilegedEditor)===null||p===void 0?void 0:p.getHTML(),document.createDocumentFragment,y=document.createElement("div"),f&&(y.innerHTML=f),h=y.querySelector(".ql-ui"),E="",h&&(h.remove(),y!=null&&(E=y.innerHTML||"")),g=_.title,O=_.content,Le=_.moduleType,X=G.getFieldsValue(),w.next=15,(0,n.updateListindexData)(_.objectId,JSON.stringify({title:X.title,content:E,moduleType:X.moduleType}),{});case 15:z=w.sent,z!=null&&z.objectId&&(U.ZP.success({content:"\u64CD\u4F5C\u6210\u529F"}),$==null||(Y=$.current)===null||Y===void 0||Y.reload()),oe(),Q(!1);case 19:case"end":return w.stop()}},m)})),children:"\u4FDD\u5B58"}),maskClosable:!1,title:"\u5BCC\u6587\u672C",width:800,open:ne,onCancel:function(){return oe()},children:(0,a.jsxs)("div",{style:{height:500,overflow:"auto"},children:[(0,a.jsxs)(D.Z,{form:G,children:[(0,a.jsx)(D.Z.Item,{name:"moduleType",label:"\u7C7B\u578B",rules:[{required:!0,message:"\u7C7B\u578B\u5FC5\u9009\uFF01"}],children:(0,a.jsx)(N.Z,{children:se.map(function(m){return(0,a.jsx)(P,{value:m.code,children:m.name},m.objectId)})})}),(0,a.jsx)(D.Z.Item,{name:"title",label:"\u540D\u79F0",rules:[{required:!0,message:"\u540D\u79F0\u5FC5\u586B\uFF01"}],children:(0,a.jsx)(x.Z,{})})]}),(0,a.jsx)(s.Z,{className:"ql-editor",ref:J,onKeyDown:function(p){if(p.code=="Enter"&&p.altKey){var l,f=(l=J.current)===null||l===void 0?void 0:l.editor;if(f){var y=f.getLength();f.insertText(y,`
`,"user"),f.setSelection(f.getLength(),0)}}},modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:[1,2,3,4,5,6,!1]}],[{list:"ordered"},{list:"bullet"}],["link","image","video"],["clean"]],syntax:{hljs:{highlight:function(p,l){var f=c.Z.highlight(p,l);return f}}}},theme:"snow",value:_.content,onChange:function(p){}})]})})]})},de=B},4701:function(q,F,t){t.d(F,{d:function(){return d}});var M={};t.r(M),t.d(M,{Login:function(){return b},getRoles:function(){return T},getUsers:function(){return N},registryfn:function(){return W},updateRole:function(){return A}});var d={};t.r(d),t.d(d,{k:function(){return U},n:function(){return M}});var K=t(43953),u=t.n(K),k=t(39346),i=t.n(k),j=t(91184),S=t.n(j),C=t(39495);function b(c){return L.apply(this,arguments)}function L(){return L=S()(u()().mark(function c(o){var s,e=arguments;return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=e.length>1&&e[1]!==void 0?e[1]:{},s.params=i()(i()({},s.params),{},{tableName:"OnlineUser"}),n.abrupt("return",(0,C.request)("",i()({method:"get",data:o},s||{})));case 3:case"end":return n.stop()}},c)})),L.apply(this,arguments)}function W(c){return R.apply(this,arguments)}function R(){return R=S()(u()().mark(function c(o){var s,e=arguments;return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=e.length>1&&e[1]!==void 0?e[1]:{},s.params=i()(i()({},s.params),{},{tableName:"OnlineUser"}),n.abrupt("return",(0,C.request)("",i()({method:"post",data:o,headers:{"content-type":"application/json"}},s||{})));case 3:case"end":return n.stop()}},c)})),R.apply(this,arguments)}function N(c){return D.apply(this,arguments)}function D(){return D=S()(u()().mark(function c(o){var s,e=arguments;return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=e.length>1&&e[1]!==void 0?e[1]:{},s.params=i()(i()({},s.params),{},{tableName:"OnlineUser"}),n.abrupt("return",(0,C.request)("",i()({method:"get",data:o},s||{})));case 3:case"end":return n.stop()}},c)})),D.apply(this,arguments)}function T(c){return I.apply(this,arguments)}function I(){return I=S()(u()().mark(function c(o){var s,e=arguments;return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=e.length>1&&e[1]!==void 0?e[1]:{},s.params=i()(i()({},s.params),{},{tableName:"Role"}),n.abrupt("return",(0,C.request)("",i()({method:"get",data:o},s||{})));case 3:case"end":return n.stop()}},c)})),I.apply(this,arguments)}function A(c){return x.apply(this,arguments)}function x(){return x=S()(u()().mark(function c(o){var s,e=arguments;return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=e.length>1&&e[1]!==void 0?e[1]:{},s.params=i()(i()({},s.params),{},{tableName:"Role"}),n.abrupt("return",(0,C.request)("".concat(o),i()({method:o?"put":"post",headers:{"content-type":"application/json"}},s||{})));case 3:case"end":return n.stop()}},c)})),x.apply(this,arguments)}var U=t(18879)},18879:function(q,F,t){t.r(F),t.d(F,{addCodeListData:function(){return A},addListindexData:function(){return S},deleteCodeListData:function(){return U},deleteListindexData:function(){return N},getCodeListData:function(){return T},getListindexData:function(){return W},updateListindexData:function(){return b}});var M=t(43953),d=t.n(M),K=t(39346),u=t.n(K),k=t(91184),i=t.n(k),j=t(39495);function S(o){return C.apply(this,arguments)}function C(){return C=i()(d()().mark(function o(s){var e,r=arguments;return d()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return e=r.length>1&&r[1]!==void 0?r[1]:{},e.params=u()(u()({},e.params),{},{tableName:"indexData"}),v.abrupt("return",(0,j.request)("",u()({method:"post",data:s,headers:{"content-type":"application/json"}},e||{})));case 3:case"end":return v.stop()}},o)})),C.apply(this,arguments)}function b(o,s){return L.apply(this,arguments)}function L(){return L=i()(d()().mark(function o(s,e){var r,n,v=arguments;return d()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return r=v.length>2&&v[2]!==void 0?v[2]:{},r.params=u()(u()({},r.params),{},{tableName:"indexData"}),n=(0,j.request)(s,u()({method:s?"put":"post",data:e,headers:{"content-type":"application/json"}},r||{})),P.abrupt("return",n);case 4:case"end":return P.stop()}},o)})),L.apply(this,arguments)}function W(o){return R.apply(this,arguments)}function R(){return R=i()(d()().mark(function o(s){var e,r,n=arguments;return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e=n.length>1&&n[1]!==void 0?n[1]:{},e.params=u()(u()({},e.params),{},{tableName:"indexData"}),r=(0,j.request)("",u()({method:"get",data:e.body||""},e||{})),a.abrupt("return",r);case 4:case"end":return a.stop()}},o)})),R.apply(this,arguments)}function N(o){return D.apply(this,arguments)}function D(){return D=i()(d()().mark(function o(s){var e,r,n=arguments;return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e=n.length>1&&n[1]!==void 0?n[1]:{},e.params=u()(u()({},e.params),{},{tableName:"indexData"}),r=(0,j.request)(s||"",u()({url:s,method:"delete",data:e.body||""},e||{})),a.abrupt("return",r);case 4:case"end":return a.stop()}},o)})),D.apply(this,arguments)}function T(o){return I.apply(this,arguments)}function I(){return I=i()(d()().mark(function o(s){var e,r,n=arguments;return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e=n.length>1&&n[1]!==void 0?n[1]:{},e.params=u()(u()({},e.params),{},{tableName:"codeList"}),r=(0,j.request)("",u()({method:"get",data:e.body||""},e||{})),a.abrupt("return",r);case 4:case"end":return a.stop()}},o)})),I.apply(this,arguments)}function A(o){return x.apply(this,arguments)}function x(){return x=i()(d()().mark(function o(s){var e,r,n,v,a=arguments;return d()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return r=a.length>1&&a[1]!==void 0?a[1]:{},n=r==null||(e=r.body)===null||e===void 0?void 0:e.objectId,r.params=u()(u()({},r.params),{},{tableName:"codeList"}),v=(0,j.request)(n||"",u()({method:n?"put":"post",data:r.body||""},r||{})),B.abrupt("return",v);case 5:case"end":return B.stop()}},o)})),x.apply(this,arguments)}function U(o){return c.apply(this,arguments)}function c(){return c=i()(d()().mark(function o(s){var e,r,n=arguments;return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e=n.length>1&&n[1]!==void 0?n[1]:{},e.params=u()(u()({},e.params),{},{tableName:"codeList"}),r=(0,j.request)(e.objectId||"",u()({method:"delete",data:e.body||""},e||{})),a.abrupt("return",r);case 4:case"end":return a.stop()}},o)})),c.apply(this,arguments)}}}]);
