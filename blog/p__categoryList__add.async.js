"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[750],{90637:function(Le,w,t){t.r(w);var Y=t(60183),M=t.n(Y),q=t(2927),ee=t.n(q),ne=t(39346),f=t.n(ne),te=t(43953),c=t.n(te),ae=t(91184),E=t.n(ae),re=t(9083),m=t.n(re),j=t(34892),oe=t(73819),y=t(45740),A=t(72049),D=t(79853),B=t(43061),_e=t(17746),S=t(76856),C=t(78329),se=t(48158),ie=t(96506),h=t(16879),ue=t(32115),u=t(38497),R=t(57664),le=t(49624),o=t(96469),Te=y.Z.Paragraph,we=y.Z.Text,de=function(){var ce=h.A.useForm(),me=m()(ce,1),g=me[0],ve=(0,u.useState)(),U=m()(ve,2),L=U[0],fe=U[1],he=(0,u.useState)({}),K=m()(he,2),p=K[0],O=K[1],Ee=(0,u.useState)({current:1,pageSize:5}),F=m()(Ee,2),s=F[0],I=F[1];(0,u.useEffect)(function(){var a;(a=T.current)===null||a===void 0||a.reload()},[s]);var W=(0,oe.useSelector)(function(a){return a.keywordns.keyword}),De=function(){var a=E()(c()().mark(function n(){var e;return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,j.d.k.getCodeListData("",{params:{count:1,skip:(s.current-1)*s.pageSize,limit:s.pageSize,where:{$and:[s.code?{code:{$regex:s.code,$options:"i"}}:null,s.name?{name:{$regex:s.name,$options:"i"}}:null,s.desc?{desc:{$regex:s.desc,$options:"i"}}:null],$or:[W?{code:{$regex:W,$options:"i"}}:{}]}}});case 2:return e=r.sent,fe(e),r.abrupt("return",e);case 5:case"end":return r.stop()}},n)}));return function(){return a.apply(this,arguments)}}(),ge=(0,u.useState)(!1),Z=m()(ge,2),pe=Z[0],$=Z[1],Pe=(0,u.useState)(""),k=m()(Pe,2),z=k[0],V=k[1],Ce=function(n){return new Promise(function(e,_){var r=new FileReader;r.readAsDataURL(n),r.onload=function(){return e(r.result)},r.onerror=function(i){return _(i)}})},Oe=function(){var a=E()(c()().mark(function n(e){return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(!e.url&&!e.preview)){r.next=4;break}return r.next=3,Ce(e.originFileObj);case 3:e.preview=r.sent;case 4:V(e.url||e.preview),$(!0);case 6:case"end":return r.stop()}},n)}));return function(e){return a.apply(this,arguments)}}(),Ie=(0,u.useRef)(),be=(0,u.useState)([]),G=m()(be,2),xe=G[0],b=G[1],T=(0,u.useRef)(),Me=(0,u.useState)({}),N=m()(Me,2),H=N[0],je=N[1],Ae=(0,u.useState)({a:1}),J=m()(Ae,2),Se=J[0],Be=J[1],Q=function(n,e){if(n==="songyubin")Re(e);else{A.ZP.error({content:"\u5BC6\u94A5\u4E0D\u6B63\u786E\uFF01"});return}},Re=function(){var a=E()(c()().mark(function n(e){var _,r,i,d,l,v,x,X;return c()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return console.log("addFormIns.getFieldValue()",g.getFieldsValue()),d=p==null?void 0:p.formData,l=d.objectId,v=g.getFieldsValue(),console.log("formvalue",v),x=v==null||(_=v.icon)===null||_===void 0?void 0:_.fileList,P.next=7,j.d.k.addCodeListData("",{body:f()(f()({},v),{},{icon:x&&(r=x[0])!==null&&r!==void 0&&r.thumbUrl?(i=x[0])===null||i===void 0?void 0:i.thumbUrl:(v==null?void 0:v.icon)||"",objectId:l||void 0,createdAt:void 0})});case 7:X=P.sent,X.objectId?(A.ZP.success({content:"\u521B\u5EFA\u6210\u529F\uFF01"}),b([]),g.resetFields(),O({show:!1}),I(l?f()({},s):{current:1,pageSize:5}),e.destroy()):A.ZP.warning({content:"\u521B\u5EFA\u5931\u8D25\uFF01"});case 9:case"end":return P.stop()}},n)}));return function(e){return a.apply(this,arguments)}}();return(0,u.useEffect)(function(){},[]),(0,u.useEffect)(function(){je({code:{show:!0,fixed:H},action:{show:!0,fixed:"right"}})},[]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ue.Z,{actionRef:T,params:Se,cardProps:{title:"\u5B57\u5178",subTitle:"\u6240\u6709\u6A21\u5757\u7B80\u4ECB",collapsible:!0,headerBordered:!0,bordered:!0},postData:function(n){return console.log("postData->rest",n),n.map(function(e){return e.name=e.name,e})},request:function(){var a=E()(c()().mark(function n(e,_,r){var i;return c()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return console.log(_,r,e),l.next=3,De();case 3:return i=l.sent,l.abrupt("return",Promise.resolve({data:i.results,success:!0,total:i.count}));case 5:case"end":return l.stop()}},n)}));return function(n,e,_){return a.apply(this,arguments)}}(),toolbar:{title:"ProTable",subTitle:"\u5217\u8868",tooltip:{icon:(0,o.jsx)(R.Z,{}),title:"tootipTitle",overlay:(0,o.jsx)("span",{children:"\u8FD9\u662F\u4E00\u4E2A\u63D0\u793A\u4FE1\u606F"})},search:{placeholder:"\u4EC5\u4EC5\u662F\u4E2A\u6837\u5F0F",onSearch:function(n){alert(n)}},multipleLine:!0},columnsState:{onChange:function(n){console.log("map>>>",n)},value:H},scroll:{y:300,x:"max-content"},onChange:function(n){var e=n.current,_=n.pageSize;console.log("onChange>>>"),I(f()(f()({},s),{},{current:e,pageSize:_||0}))},pagination:{showSizeChanger:!0,pageSize:s.pageSize,total:L==null?void 0:L.count},rowKey:"objectId",search:{optionRender:function(n,e,_){return[].concat(ee()(_),[(0,o.jsx)(D.ZP,{onClick:function(){O({show:!0,formData:{}})},children:"\u65B0\u589E"},"vv-1")])}},onReset:function(){I({current:1,pageSize:5})},onSubmit:function(n){var e;console.log("rest",n),(e=T.current)===null||e===void 0||e.reload()},columns:[{key:"icon",width:80,title:"icon",dataIndex:"icon",render:function(n,e){return(0,o.jsx)(B.Z,{width:50,height:50,src:e.icon})},search:!1},{key:"code",width:100,title:"code",dataIndex:"code"},{key:"name",width:100,valueType:"select",valueEnum:{all:{text:"\u5168\u90E8"},\u4ED8\u5C0F\u5C0F:{text:"\u4ED8\u5C0F\u5C0F"},\u66F2\u4E3D\u4E3D:{text:"\u66F2\u4E3D\u4E3D"},\u6797\u4E1C\u4E1C:{text:"\u6797\u4E1C\u4E1C"},\u9648\u5E05\u5E05:{text:"\u9648\u5E05\u5E05"},\u517C\u67D0\u67D0:{text:"\u517C\u67D0\u67D0"}},title:"\u522B\u540D",dataIndex:"name"},{key:"desc",width:500,title:"\u63CF\u8FF0",dataIndex:"desc"},M()(M()(M()({key:"action",width:160,hideInSearch:!0,title:"\u64CD\u4F5C"},"width",130),"align","center"),"render",function(n,e,_,r,i){return(0,o.jsxs)(_e.Z,{children:[(0,o.jsx)(D.ZP,{variant:"link",color:"green",onClick:function(){O({show:!0,formData:e}),g.setFieldsValue(e),b([{uid:""+Date.now(),name:"icon",thumbUrl:typeof(e==null?void 0:e.icon)=="string"?e==null?void 0:e.icon:""}]),console.log("uploadRef",Ie)},children:"\u7F16\u8F91"}),(0,o.jsx)(D.ZP,{variant:"link",color:"danger",onClick:function(){S.Z.confirm({icon:(0,o.jsx)(R.Z,{}),title:"\u5220\u9664",content:"\u786E\u8BA4\u5220\u9664\u4E48\uFF1F",onOk:function(){j.d.k.deleteCodeListData("",{objectId:e.objectId}),setTimeout(function(){I(f()({},s))},200)}})},children:"\u5220\u9664"})]})})]}),(0,o.jsx)("hr",{}),(0,o.jsx)(S.Z,{title:"code\u5B57\u5178".concat(p.objectId?"\u7F16\u8F91":"\u65B0\u589E"),open:p.show,onOk:E()(c()().mark(function a(){var n,e;return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:n="",e=S.Z.confirm({closable:!0,title:"\u8BF7\u627E\u535A\u4E3B\u8981\u5BC6\u94A5",icon:(0,o.jsx)(R.Z,{}),afterOpenChange:function(){var d=document.querySelector(".miyao");d.focus()},content:(0,o.jsx)(C.Z,{className:"miyao",onKeyDown:function(d){d.keyCode===13&&Q(n,e)},onChange:function(d){n=d.target.value}}),footer:(0,o.jsx)(se.Z,{justify:"flex-end",style:{paddingTop:10},children:(0,o.jsx)(D.ZP,{type:"primary",onClick:function(){Q(n,e)},children:"\u786E\u8BA4"})})});case 2:case"end":return r.stop()}},a)})),onCancel:function(){b([]),O({show:!1})},children:(0,o.jsxs)(h.A,{form:g,submitter:!1,layout:"horizontal",children:[(0,o.jsx)(h.A.Item,{label:"icon",name:"icon",children:(0,o.jsx)(ie.Z,{listType:"picture-card",fileList:xe,onChange:function(n){console.log("rest",n),n&&b(n.fileList)},onPreview:Oe,children:(0,o.jsx)(D.ZP,{icon:(0,o.jsx)(le.Z,{}),children:"\u4E0A\u4F20"})})}),(0,o.jsx)(h.A.Item,{label:"code",name:"code",children:(0,o.jsx)(C.Z,{})}),(0,o.jsx)(h.A.Item,{label:"\u522B\u540D",name:"name",children:(0,o.jsx)(C.Z,{})}),(0,o.jsx)(h.A.Item,{label:"\u63CF\u8FF0",name:"desc",children:(0,o.jsx)(C.Z,{})})]})}),z&&(0,o.jsx)(B.Z,{wrapperStyle:{display:"none"},preview:{visible:pe,onVisibleChange:function(n){return $(n)},afterOpenChange:function(n){return!n&&V("")}},src:z})]})};w.default=de}}]);
