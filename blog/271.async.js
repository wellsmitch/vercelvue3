"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[271],{80165:function(ve,Q,t){var J=t(7749),h=t(82574),A=t(35569),H=t(77511),X=t(1193),d=t(43015),k=t(61060),q=t(38497),L=t(51984),P=t(96469),G=["fieldProps","proFieldProps"],ee=["fieldProps","proFieldProps"],M="text",ne=function(v){var n=v.fieldProps,E=v.proFieldProps,o=(0,A.Z)(v,G);return(0,P.jsx)(L.Z,(0,h.Z)({valueType:M,fieldProps:n,filedConfig:{valueType:M},proFieldProps:E},o))},te=function(v){var n=(0,H.Z)(v.open||!1,{value:v.open,onChange:v.onOpenChange}),E=(0,J.Z)(n,2),o=E[0],U=E[1];return(0,P.jsx)(X.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(b){var m,K=b.getFieldValue(v.name||[]);return(0,P.jsx)(d.Z,(0,h.Z)((0,h.Z)({getPopupContainer:function(e){return e&&e.parentNode?e.parentNode:e},onOpenChange:function(e){return U(e)},content:(0,P.jsxs)("div",{style:{padding:"4px 0"},children:[(m=v.statusRender)===null||m===void 0?void 0:m.call(v,K),v.strengthText?(0,P.jsx)("div",{style:{marginTop:10},children:(0,P.jsx)("span",{children:v.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},v.popoverProps),{},{open:o,children:v.children}))}})},re=function(v){var n=v.fieldProps,E=v.proFieldProps,o=(0,A.Z)(v,ee),U=(0,q.useState)(!1),j=(0,J.Z)(U,2),b=j[0],m=j[1];return n!=null&&n.statusRender&&o.name?(0,P.jsx)(te,{name:o.name,statusRender:n==null?void 0:n.statusRender,popoverProps:n==null?void 0:n.popoverProps,strengthText:n==null?void 0:n.strengthText,open:b,onOpenChange:m,children:(0,P.jsx)("div",{children:(0,P.jsx)(L.Z,(0,h.Z)({valueType:"password",fieldProps:(0,h.Z)((0,h.Z)({},(0,k.Z)(n,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(O){var e;n==null||(e=n.onBlur)===null||e===void 0||e.call(n,O),m(!1)},onClick:function(O){var e;n==null||(e=n.onClick)===null||e===void 0||e.call(n,O),m(!0)}}),proFieldProps:E,filedConfig:{valueType:M}},o))})}):(0,P.jsx)(L.Z,(0,h.Z)({valueType:"password",fieldProps:n,proFieldProps:E,filedConfig:{valueType:M}},o))},W=ne;W.Password=re,W.displayName="ProFormComponent",Q.Z=W},67733:function(ve,Q,t){var J=t(43599),h=t(7749),A=t(35569),H=t(40173),X=t(53648),d=t(82574),k=t(30606),q=t(61343),L=t(90537),P=t(71398),G=t(88100),ee=t(85563),M=t(42028),ne=t(61463),te=t(45401),re=t(1193),W=t(77511),B=t(96619),v=t(3494),n=t(38497),E=t(90908),o=t(96469),U=["onTableChange","maxLength","formItemProps","recordCreatorProps","rowKey","controlled","defaultValue","onChange","editableFormRef"],j=["record","position","creatorButtonText","newRecordType","parentKey","style"],b=n.createContext(void 0);function m(e){var g=e.children,I=e.record,F=e.position,V=e.newRecordType,D=e.parentKey,S=(0,n.useContext)(b);return n.cloneElement(g,(0,d.Z)((0,d.Z)({},g.props),{},{onClick:function(){var $=(0,X.Z)((0,H.Z)().mark(function le(ae){var Y,z,T,Z;return(0,H.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(Y=(z=g.props).onClick)===null||Y===void 0?void 0:Y.call(z,ae);case 2:if(Z=c.sent,Z!==!1){c.next=5;break}return c.abrupt("return");case 5:S==null||(T=S.current)===null||T===void 0||T.addEditRecord(I,{position:F,newRecordType:V,parentKey:D});case 6:case"end":return c.stop()}},le)}));function R(le){return $.apply(this,arguments)}return R}()}))}function K(e){var g,I,F=(0,P.YB)(),V=e.onTableChange,D=e.maxLength,S=e.formItemProps,$=e.recordCreatorProps,R=e.rowKey,le=e.controlled,ae=e.defaultValue,Y=e.onChange,z=e.editableFormRef,T=(0,A.Z)(e,U),Z=(0,n.useRef)(void 0),p=(0,n.useRef)(),c=(0,n.useRef)();(0,n.useImperativeHandle)(T.actionRef,function(){return p.current},[p.current]);var _e=(0,W.Z)(function(){return e.value||ae||[]},{value:e.value,onChange:e.onChange}),ue=(0,h.Z)(_e,2),u=ue[0],ce=ue[1],x=n.useMemo(function(){return typeof R=="function"?R:function(r,_){return r[R]||_}},[R]),oe=(0,G.J)(function(r){if(typeof r=="number"&&!e.name){if(r>=u.length)return r;var _=u&&u[r];return x==null?void 0:x(_,r)}if((typeof r=="string"||r>=u.length)&&e.name){var l=u.findIndex(function(a,i){var s;return(x==null||(s=x(a,i))===null||s===void 0?void 0:s.toString())===(r==null?void 0:r.toString())});if(l!==-1)return l}return r});(0,n.useImperativeHandle)(z,function(){var r=function(a){var i,s;if(a==null)throw new Error("rowIndex is required");var f=oe(a),C=[e.name,(i=f==null?void 0:f.toString())!==null&&i!==void 0?i:""].flat(1).filter(Boolean);return(s=c.current)===null||s===void 0?void 0:s.getFieldValue(C)},_=function(){var a,i=[e.name].flat(1).filter(Boolean);if(Array.isArray(i)&&i.length===0){var s,f=(s=c.current)===null||s===void 0?void 0:s.getFieldsValue();return Array.isArray(f)?f:Object.keys(f).map(function(C){return f[C]})}return(a=c.current)===null||a===void 0?void 0:a.getFieldValue(i)};return(0,d.Z)((0,d.Z)({},c.current),{},{getRowData:r,getRowsData:_,setRowData:function(a,i){var s,f;if(a==null)throw new Error("rowIndex is required");var C=oe(a),N=[e.name,(s=C==null?void 0:C.toString())!==null&&s!==void 0?s:""].flat(1).filter(Boolean),De=Object.assign({},(0,d.Z)((0,d.Z)({},r(a)),i||{})),Me=(0,v.Z)({},N,De);return(f=c.current)===null||f===void 0||f.setFieldsValue(Me),!0}})},[oe,e.name,c.current]),(0,n.useEffect)(function(){e.controlled&&(u||[]).forEach(function(r,_){var l;(l=c.current)===null||l===void 0||l.setFieldsValue((0,J.Z)({},"".concat(x(r,_)),r))},{})},[(0,ee.ZP)(u),e.controlled]),(0,n.useEffect)(function(){if(e.name){var r;c.current=e==null||(r=e.editable)===null||r===void 0?void 0:r.form}},[(g=e.editable)===null||g===void 0?void 0:g.form,e.name]);var y=$||{},fe=y.record,ie=y.position,Pe=y.creatorButtonText,me=y.newRecordType,he=y.parentKey,Ee=y.style,ge=(0,A.Z)(y,j),se=ie==="top",w=(0,n.useMemo)(function(){return typeof D=="number"&&D<=(u==null?void 0:u.length)?!1:$!==!1&&(0,o.jsx)(m,{record:(0,M.h)(fe,u==null?void 0:u.length,u)||{},position:ie,parentKey:(0,M.h)(he,u==null?void 0:u.length,u),newRecordType:me,children:(0,o.jsx)(te.ZP,(0,d.Z)((0,d.Z)({type:"dashed",style:(0,d.Z)({display:"block",margin:"10px 0",width:"100%"},Ee),icon:(0,o.jsx)(k.Z,{})},ge),{},{children:Pe||F.getMessage("editableTable.action.add","\u6DFB\u52A0\u4E00\u884C\u6570\u636E")}))})},[$,D,u==null?void 0:u.length]),Ce=(0,n.useMemo)(function(){return w?se?{components:{header:{wrapper:function(_){var l,a=_.className,i=_.children;return(0,o.jsxs)("thead",{className:a,children:[i,(0,o.jsxs)("tr",{style:{position:"relative"},children:[(0,o.jsx)("td",{colSpan:0,style:{visibility:"hidden"},children:w}),(0,o.jsx)("td",{style:{position:"absolute",left:0,width:"100%"},colSpan:(l=T.columns)===null||l===void 0?void 0:l.length,children:w})]})]})}}}}:{tableViewRender:function(_,l){var a,i;return(0,o.jsxs)(o.Fragment,{children:[(a=(i=e.tableViewRender)===null||i===void 0?void 0:i.call(e,_,l))!==null&&a!==void 0?a:l,w]})}}:{}},[se,w]),de=(0,d.Z)({},e.editable),Oe=(0,G.J)(function(r,_){var l,a,i;if((l=e.editable)===null||l===void 0||(a=l.onValuesChange)===null||a===void 0||a.call(l,r,_),(i=e.onValuesChange)===null||i===void 0||i.call(e,_,r),e.controlled){var s;e==null||(s=e.onChange)===null||s===void 0||s.call(e,_)}});return(e!=null&&e.onValuesChange||(I=e.editable)!==null&&I!==void 0&&I.onValuesChange||e.controlled&&e!==null&&e!==void 0&&e.onChange)&&(de.onValuesChange=Oe),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(b.Provider,{value:p,children:(0,o.jsx)(E.Z,(0,d.Z)((0,d.Z)((0,d.Z)({search:!1,options:!1,pagination:!1,rowKey:R,revalidateOnFocus:!1},T),Ce),{},{tableLayout:"fixed",actionRef:p,onChange:V,editable:(0,d.Z)((0,d.Z)({},de),{},{formProps:(0,d.Z)({formRef:c},de.formProps)}),dataSource:u,onDataSourceChange:function(_){if(ce(_),e.name&&ie==="top"){var l,a=(0,v.Z)({},[e.name].flat(1).filter(Boolean),_);(l=c.current)===null||l===void 0||l.setFieldsValue(a)}}}))}),e.name?(0,o.jsx)(q.Z,{name:[e.name],children:function(_){var l,a;if(!Z.current)return Z.current=u,null;var i=(0,B.Z)(_,[e.name].flat(1)),s=i==null?void 0:i.find(function(f,C){var N;return!(0,ne.A)(f,(N=Z.current)===null||N===void 0?void 0:N[C])});return Z.current=u,s&&(e==null||(l=e.editable)===null||l===void 0||(a=l.onValuesChange)===null||a===void 0||a.call(l,s,i)),null}}):null]})}function O(e){var g=L.ZP.useFormInstance();return e.name?(0,o.jsx)(re.Z.Item,(0,d.Z)((0,d.Z)({style:{maxWidth:"100%"},shouldUpdate:function(F,V){var D=[e.name].flat(1);try{return JSON.stringify((0,B.Z)(F,D))!==JSON.stringify((0,B.Z)(V,D))}catch(S){return!0}}},e==null?void 0:e.formItemProps),{},{name:e.name,children:(0,o.jsx)(K,(0,d.Z)((0,d.Z)({tableLayout:"fixed",scroll:{x:"max-content"}},e),{},{editable:(0,d.Z)((0,d.Z)({},e.editable),{},{form:g})}))})):(0,o.jsx)(K,(0,d.Z)({tableLayout:"fixed",scroll:{x:"max-content"}},e))}O.RecordCreator=m,Q.Z=O}}]);
