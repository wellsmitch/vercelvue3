"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[463],{67733:function(pe,G,t){var z=t(43599),p=t(7749),k=t(35569),s=t(40173),re=t(53648),r=t(82574),S=t(30606),w=t(61343),I=t(90537),K=t(71398),A=t(88100),X=t(85563),y=t(42028),ae=t(61463),D=t(45401),oe=t(1193),x=t(77511),J=t(96619),U=t(3494),u=t(38497),b=t(90908),o=t(96469),l=["onTableChange","maxLength","formItemProps","recordCreatorProps","rowKey","controlled","defaultValue","onChange","editableFormRef"],n=["record","position","creatorButtonText","newRecordType","parentKey","style"],i=u.createContext(void 0);function a(e){var M=e.children,q=e.record,ee=e.position,te=e.newRecordType,F=e.parentKey,ue=(0,u.useContext)(i);return u.cloneElement(M,(0,r.Z)((0,r.Z)({},M.props),{},{onClick:function(){var ne=(0,re.Z)((0,s.Z)().mark(function me(ve){var le,ie,H,j;return(0,s.Z)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,(le=(ie=M.props).onClick)===null||le===void 0?void 0:le.call(ie,ve);case 2:if(j=C.sent,j!==!1){C.next=5;break}return C.abrupt("return");case 5:ue==null||(H=ue.current)===null||H===void 0||H.addEditRecord(q,{position:ee,newRecordType:te,parentKey:F});case 6:case"end":return C.stop()}},me)}));function $(me){return ne.apply(this,arguments)}return $}()}))}function O(e){var M,q,ee=(0,K.YB)(),te=e.onTableChange,F=e.maxLength,ue=e.formItemProps,ne=e.recordCreatorProps,$=e.rowKey,me=e.controlled,ve=e.defaultValue,le=e.onChange,ie=e.editableFormRef,H=(0,k.Z)(e,l),j=(0,u.useRef)(void 0),se=(0,u.useRef)(),C=(0,u.useRef)();(0,u.useImperativeHandle)(H.actionRef,function(){return se.current},[se.current]);var Ee=(0,x.Z)(function(){return e.value||ve||[]},{value:e.value,onChange:e.onChange}),ge=(0,p.Z)(Ee,2),h=ge[0],T=ge[1],V=u.useMemo(function(){return typeof $=="function"?$:function(c,R){return c[$]||R}},[$]),de=(0,A.J)(function(c){if(typeof c=="number"&&!e.name){if(c>=h.length)return c;var R=h&&h[c];return V==null?void 0:V(R,c)}if((typeof c=="string"||c>=h.length)&&e.name){var m=h.findIndex(function(f,g){var P;return(V==null||(P=V(f,g))===null||P===void 0?void 0:P.toString())===(c==null?void 0:c.toString())});if(m!==-1)return m}return c});(0,u.useImperativeHandle)(ie,function(){var c=function(f){var g,P;if(f==null)throw new Error("rowIndex is required");var B=de(f),Y=[e.name,(g=B==null?void 0:B.toString())!==null&&g!==void 0?g:""].flat(1).filter(Boolean);return(P=C.current)===null||P===void 0?void 0:P.getFieldValue(Y)},R=function(){var f,g=[e.name].flat(1).filter(Boolean);if(Array.isArray(g)&&g.length===0){var P,B=(P=C.current)===null||P===void 0?void 0:P.getFieldsValue();return Array.isArray(B)?B:Object.keys(B).map(function(Y){return B[Y]})}return(f=C.current)===null||f===void 0?void 0:f.getFieldValue(g)};return(0,r.Z)((0,r.Z)({},C.current),{},{getRowData:c,getRowsData:R,setRowData:function(f,g){var P,B;if(f==null)throw new Error("rowIndex is required");var Y=de(f),he=[e.name,(P=Y==null?void 0:Y.toString())!==null&&P!==void 0?P:""].flat(1).filter(Boolean),Pe=Object.assign({},(0,r.Z)((0,r.Z)({},c(f)),g||{})),Ce=(0,U.Z)({},he,Pe);return(B=C.current)===null||B===void 0||B.setFieldsValue(Ce),!0}})},[de,e.name,C.current]),(0,u.useEffect)(function(){e.controlled&&(h||[]).forEach(function(c,R){var m;(m=C.current)===null||m===void 0||m.setFieldsValue((0,z.Z)({},"".concat(V(c,R)),c))},{})},[(0,X.ZP)(h),e.controlled]),(0,u.useEffect)(function(){if(e.name){var c;C.current=e==null||(c=e.editable)===null||c===void 0?void 0:c.form}},[(M=e.editable)===null||M===void 0?void 0:M.form,e.name]);var E=ne||{},v=E.record,d=E.position,W=E.creatorButtonText,L=E.newRecordType,N=E.parentKey,Z=E.style,Q=(0,k.Z)(E,n),_e=d==="top",ce=(0,u.useMemo)(function(){return typeof F=="number"&&F<=(h==null?void 0:h.length)?!1:ne!==!1&&(0,o.jsx)(a,{record:(0,y.h)(v,h==null?void 0:h.length,h)||{},position:d,parentKey:(0,y.h)(N,h==null?void 0:h.length,h),newRecordType:L,children:(0,o.jsx)(D.ZP,(0,r.Z)((0,r.Z)({type:"dashed",style:(0,r.Z)({display:"block",margin:"10px 0",width:"100%"},Z),icon:(0,o.jsx)(S.Z,{})},Q),{},{children:W||ee.getMessage("editableTable.action.add","\u6DFB\u52A0\u4E00\u884C\u6570\u636E")}))})},[ne,F,h==null?void 0:h.length]),fe=(0,u.useMemo)(function(){return ce?_e?{components:{header:{wrapper:function(R){var m,f=R.className,g=R.children;return(0,o.jsxs)("thead",{className:f,children:[g,(0,o.jsxs)("tr",{style:{position:"relative"},children:[(0,o.jsx)("td",{colSpan:0,style:{visibility:"hidden"},children:ce}),(0,o.jsx)("td",{style:{position:"absolute",left:0,width:"100%"},colSpan:(m=H.columns)===null||m===void 0?void 0:m.length,children:ce})]})]})}}}}:{tableViewRender:function(R,m){var f,g;return(0,o.jsxs)(o.Fragment,{children:[(f=(g=e.tableViewRender)===null||g===void 0?void 0:g.call(e,R,m))!==null&&f!==void 0?f:m,ce]})}}:{}},[_e,ce]),De=(0,r.Z)({},e.editable),be=(0,A.J)(function(c,R){var m,f,g;if((m=e.editable)===null||m===void 0||(f=m.onValuesChange)===null||f===void 0||f.call(m,c,R),(g=e.onValuesChange)===null||g===void 0||g.call(e,R,c),e.controlled){var P;e==null||(P=e.onChange)===null||P===void 0||P.call(e,R)}});return(e!=null&&e.onValuesChange||(q=e.editable)!==null&&q!==void 0&&q.onValuesChange||e.controlled&&e!==null&&e!==void 0&&e.onChange)&&(De.onValuesChange=be),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.Provider,{value:se,children:(0,o.jsx)(b.Z,(0,r.Z)((0,r.Z)((0,r.Z)({search:!1,options:!1,pagination:!1,rowKey:$,revalidateOnFocus:!1},H),fe),{},{tableLayout:"fixed",actionRef:se,onChange:te,editable:(0,r.Z)((0,r.Z)({},De),{},{formProps:(0,r.Z)({formRef:C},De.formProps)}),dataSource:h,onDataSourceChange:function(R){if(T(R),e.name&&d==="top"){var m,f=(0,U.Z)({},[e.name].flat(1).filter(Boolean),R);(m=C.current)===null||m===void 0||m.setFieldsValue(f)}}}))}),e.name?(0,o.jsx)(w.Z,{name:[e.name],children:function(R){var m,f;if(!j.current)return j.current=h,null;var g=(0,J.Z)(R,[e.name].flat(1)),P=g==null?void 0:g.find(function(B,Y){var he;return!(0,ae.A)(B,(he=j.current)===null||he===void 0?void 0:he[Y])});return j.current=h,P&&(e==null||(m=e.editable)===null||m===void 0||(f=m.onValuesChange)===null||f===void 0||f.call(m,P,g)),null}}):null]})}function _(e){var M=I.ZP.useFormInstance();return e.name?(0,o.jsx)(oe.Z.Item,(0,r.Z)((0,r.Z)({style:{maxWidth:"100%"},shouldUpdate:function(ee,te){var F=[e.name].flat(1);try{return JSON.stringify((0,J.Z)(ee,F))!==JSON.stringify((0,J.Z)(te,F))}catch(ue){return!0}}},e==null?void 0:e.formItemProps),{},{name:e.name,children:(0,o.jsx)(O,(0,r.Z)((0,r.Z)({tableLayout:"fixed",scroll:{x:"max-content"}},e),{},{editable:(0,r.Z)((0,r.Z)({},e.editable),{},{form:M})}))})):(0,o.jsx)(O,(0,r.Z)({tableLayout:"fixed",scroll:{x:"max-content"}},e))}_.RecordCreator=a,G.Z=_},64093:function(pe,G,t){t.r(G);var z=t(43953),p=t.n(z),k=t(91184),s=t.n(k),re=t(39346),r=t.n(re),S=t(2927),w=t.n(S),I=t(9083),K=t.n(I),A=t(4701),X=t(67733),y=t(38497),ae=t(98958),D=t(37719),oe=t(670),x=t(45401),J=t(45839),U=t(39495),u=t(96469),b=function(){var l=(0,y.useState)(!0),n=K()(l,2),i=n[0],a=n[1],O=(0,y.useState)(!0),_=K()(O,2),e=_[0],M=_[1],q=(0,y.useState)(!1),ee=K()(q,2),te=ee[0],F=ee[1],ue=(0,y.useState)(!1),ne=K()(ue,2),$=ne[0],me=ne[1],ve=(0,y.useState)(0),le=K()(ve,2),ie=le[0],H=le[1],j=(0,y.useRef)(),se=(0,y.useState)([]),C=K()(se,2),Ee=C[0],ge=C[1],h=(0,U.useModel)("@@initialState"),T=h.initialState,V=h.setInitialState,de=(0,y.useRef)();return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("h1",{className:"red",children:"redredred"}),(0,u.jsxs)(ae.Z,{size:[10,10],wrap:!0,children:[(0,u.jsxs)(D.ZP.Group,{buttonStyle:"solid",optionType:"button",value:i,onChange:function(v){var d=v.target;return a(d.value||!1)},children:[(0,u.jsx)(D.ZP,{value:!0,children:"\u5C55\u793A proTableSearch"}),(0,u.jsx)(D.ZP,{value:!1,children:"\u4E0D\u5C55\u793A proTableSearch"})]}),(0,u.jsxs)(D.ZP.Group,{optionType:"button",value:e,onChange:function(v){var d=v.target;return M(d.value||!1)},children:[(0,u.jsx)(D.ZP,{value:!0,children:"\u5C55\u793A toolBar"}),(0,u.jsx)(D.ZP,{value:!1,children:"\u4E0D\u5C55\u793A toolBar"})]}),(0,u.jsxs)(D.ZP.Group,{optionType:"button",value:te,onChange:function(v){var d=v.target;return F(d.value||!1)},children:[(0,u.jsx)(D.ZP,{value:!0,children:"cardBorderedSearch true"}),(0,u.jsx)(D.ZP,{value:!1,children:"cardBorderedSearch false"})]}),(0,u.jsxs)(D.ZP.Group,{optionType:"button",value:$,onChange:function(v){var d=v.target;return me(d.value||!1)},children:[(0,u.jsx)(D.ZP,{value:!0,children:"\u5C55\u793A\u8FB9\u6846"}),(0,u.jsx)(D.ZP,{value:!1,children:"\u4E0D\u5C55\u793A\u8FB9\u6846"})]}),(0,u.jsx)(oe.Z,{addonBefore:"\u67E5\u8BE2\u7684debounceTime",value:ie,step:1e3,onChange:function(v){return H(v||0)}})]}),(0,u.jsx)(X.Z,{actionRef:de,recordCreatorProps:{record:function(){return{objectId:(Math.random()*1e6).toFixed(0)}}},search:i?{optionRender:function(v,d,W){return[].concat(w()(W),[(0,u.jsxs)(x.ZP,{onClick:function(){V(r()(r()({},T),{},{menuRenderFlag:!(T!=null&&T.menuRenderFlag)}))},children:["\u4FA7\u8FB9\u83DC\u5355",T!=null&&T.menuRenderFlag?"\u663E\u793A":"\u9690\u85CF"]}),(0,u.jsxs)(x.ZP,{onClick:function(){V(r()(r()({},T),{},{topFlag:!(T!=null&&T.topFlag)}))},children:["\u5934\u90E8",T!=null&&T.topFlag?"\u663E\u793A":"\u9690\u85CF"]})])}}:!1,headerTitle:"\u5DE6\u4E0A\u89D2\u7684\u6807\u9898",tooltip:"\u5DE6\u4E0A\u89D2\u7684\u6807\u9898\u7684\u4E00\u4E9B\u89E3\u91CA",pagination:{showQuickJumper:!0,pageSize:5,pageSizeOptions:[5,10,15,30,100],onChange:function(v,d){console.log("paination>>>",v,d)},showSizeChanger:{},onShowSizeChange:function(v,d){console.log("onShowSizeChange>>>",v,d)}},bordered:$,cardBordered:{table:te},loading:{tip:123},virtual:!0,debounceTime:ie,rowSelection:{columnWidth:20},editable:{type:"multiple",editableKeys:Ee,onSave:function(){var E=s()(p()().mark(function d(W,L,N){var Z;return p()().wrap(function(_e){for(;;)switch(_e.prev=_e.next){case 0:console.log(W,L,N),Z=JSON.parse(JSON.stringify(L)),delete Z.createdAt,delete Z.updatedAt,delete Z.objectId,delete Z.index,A.d.n.updateRole(N.createdAt?N.objectId:"",{data:Z}).then(function(ce){var fe;(fe=de.current)===null||fe===void 0||fe.reload()});case 7:case"end":return _e.stop()}},d)}));function v(d,W,L){return E.apply(this,arguments)}return v}(),onChange:ge},formRef:j,toolBarRender:e?function(){return[(0,u.jsx)(x.ZP,{onClick:function(){if(console.log(j.current),j.current){var v=j.current.getFieldsValue();Object.keys(v).length>0&&(console.log(j.current),A.d.n.updateRole("",r()({},j.current.getFieldsValue())),J.ZP.success({message:"\u65B0\u589E\u6210\u529F"}),j.current.resetFields(),j.current.submit())}},children:"\u63D0\u4EA4"},"submit")]}:!1,rowKey:"objectId",options:!1,type:"descriptions",cardProps:{title:"\u4E1A\u52A1\u5B9A\u5236",bordered:!0,collapsible:!0},tableAlertRender:function(v){return console.log("rest",v),(0,u.jsx)("div",{children:"\u60A8\u5DF2\u7ECF\u5F00\u59CB\u9009\u62E9\u6570\u636E"})},tableAlertOptionRender:function(v){return(0,u.jsx)(x.ZP,{onClick:function(){return v.onCleanSelected()},children:"\u60F3\u53D6\u6D88\u9009\u62E9"})},dateFormatter:"string",columns:[{key:"code",title:"code",width:260,dataIndex:"code"},{key:"name",editable:function(v,d,W){return W!==0},title:"\u89D2\u8272\u522B\u540D",dataIndex:"name",width:260},{title:"\u64CD\u4F5C",valueType:"option",width:250,render:function(v,d,W,L){return[(0,u.jsx)("a",{onClick:function(){var Z;console.log(L),L==null||(Z=L.startEditable)===null||Z===void 0||Z.call(L,d.objectId)},children:"\u7F16\u8F91"},"editable"),(0,u.jsx)(X.Z.RecordCreator,{record:r()(r()({},d),{},{id:(Math.random()*1e6).toFixed(0)}),children:(0,u.jsx)("a",{children:"\u590D\u5236\u6B64\u9879\u5230\u672B\u5C3E"})},"copy")]}}],request:function(){var E=s()(p()().mark(function v(d,W,L){var N;return p()().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return console.log("********",d,W,L),Q.next=3,A.d.n.getRoles("",{params:{order:"createdAt",where:r()(r()({},d.code?{code:{$in:[d.code]}}:{}),d.name?{name:{$regex:d.name,$options:"i"}}:{})}});case 3:return N=Q.sent,Q.abrupt("return",{data:N.results,success:!0,total:N.results.length});case 5:case"end":return Q.stop()}},v)}));return function(v,d,W){return E.apply(this,arguments)}}()})]})};G.default=b},4701:function(pe,G,t){t.d(G,{d:function(){return p}});var z={};t.r(z),t.d(z,{Login:function(){return K},getRoles:function(){return oe},getUsers:function(){return ae},registryfn:function(){return X},updateRole:function(){return J}});var p={};t.r(p),t.d(p,{k:function(){return u},n:function(){return z}});var k=t(43953),s=t.n(k),re=t(39346),r=t.n(re),S=t(91184),w=t.n(S),I=t(39495);function K(b){return A.apply(this,arguments)}function A(){return A=w()(s()().mark(function b(o){var l,n=arguments;return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return l=n.length>1&&n[1]!==void 0?n[1]:{},l.params=r()(r()({},l.params),{},{tableName:"OnlineUser"}),a.abrupt("return",(0,I.request)("",r()({method:"get",data:o},l||{})));case 3:case"end":return a.stop()}},b)})),A.apply(this,arguments)}function X(b){return y.apply(this,arguments)}function y(){return y=w()(s()().mark(function b(o){var l,n=arguments;return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return l=n.length>1&&n[1]!==void 0?n[1]:{},l.params=r()(r()({},l.params),{},{tableName:"OnlineUser"}),a.abrupt("return",(0,I.request)("",r()({method:"post",data:o,headers:{"content-type":"application/json"}},l||{})));case 3:case"end":return a.stop()}},b)})),y.apply(this,arguments)}function ae(b){return D.apply(this,arguments)}function D(){return D=w()(s()().mark(function b(o){var l,n=arguments;return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return l=n.length>1&&n[1]!==void 0?n[1]:{},l.params=r()(r()({},l.params),{},{tableName:"OnlineUser"}),a.abrupt("return",(0,I.request)("",r()({method:"get",data:o},l||{})));case 3:case"end":return a.stop()}},b)})),D.apply(this,arguments)}function oe(b){return x.apply(this,arguments)}function x(){return x=w()(s()().mark(function b(o){var l,n=arguments;return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return l=n.length>1&&n[1]!==void 0?n[1]:{},l.params=r()(r()({},l.params),{},{tableName:"Role"}),a.abrupt("return",(0,I.request)("",r()({method:"get",data:o},l||{})));case 3:case"end":return a.stop()}},b)})),x.apply(this,arguments)}function J(b){return U.apply(this,arguments)}function U(){return U=w()(s()().mark(function b(o){var l,n=arguments;return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return l=n.length>1&&n[1]!==void 0?n[1]:{},l.params=r()(r()({},l.params),{},{tableName:"Role"}),a.abrupt("return",(0,I.request)("".concat(o),r()({method:o?"put":"post",headers:{"content-type":"application/json"}},l||{})));case 3:case"end":return a.stop()}},b)})),U.apply(this,arguments)}var u=t(18879)},18879:function(pe,G,t){t.r(G),t.d(G,{addCodeListData:function(){return J},addListindexData:function(){return w},deleteCodeListData:function(){return u},deleteListindexData:function(){return ae},getCodeListData:function(){return oe},getListindexData:function(){return X},updateListindexData:function(){return K}});var z=t(43953),p=t.n(z),k=t(39346),s=t.n(k),re=t(91184),r=t.n(re),S=t(39495);function w(o){return I.apply(this,arguments)}function I(){return I=r()(p()().mark(function o(l){var n,i=arguments;return p()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return n=i.length>1&&i[1]!==void 0?i[1]:{},n.params=s()(s()({},n.params),{},{tableName:"indexData"}),O.abrupt("return",(0,S.request)("",s()({method:"post",data:l,headers:{"content-type":"application/json"}},n||{})));case 3:case"end":return O.stop()}},o)})),I.apply(this,arguments)}function K(o,l){return A.apply(this,arguments)}function A(){return A=r()(p()().mark(function o(l,n){var i,a,O=arguments;return p()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=O.length>2&&O[2]!==void 0?O[2]:{},i.params=s()(s()({},i.params),{},{tableName:"indexData"}),a=(0,S.request)(l,s()({method:l?"put":"post",data:n,headers:{"content-type":"application/json"}},i||{})),e.abrupt("return",a);case 4:case"end":return e.stop()}},o)})),A.apply(this,arguments)}function X(o){return y.apply(this,arguments)}function y(){return y=r()(p()().mark(function o(l){var n,i,a=arguments;return p()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return n=a.length>1&&a[1]!==void 0?a[1]:{},n.params=s()(s()({},n.params),{},{tableName:"indexData"}),i=(0,S.request)("",s()({method:"get",data:n.body||""},n||{})),_.abrupt("return",i);case 4:case"end":return _.stop()}},o)})),y.apply(this,arguments)}function ae(o){return D.apply(this,arguments)}function D(){return D=r()(p()().mark(function o(l){var n,i,a=arguments;return p()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return n=a.length>1&&a[1]!==void 0?a[1]:{},n.params=s()(s()({},n.params),{},{tableName:"indexData"}),i=(0,S.request)(l||"",s()({url:l,method:"delete",data:n.body||""},n||{})),_.abrupt("return",i);case 4:case"end":return _.stop()}},o)})),D.apply(this,arguments)}function oe(o){return x.apply(this,arguments)}function x(){return x=r()(p()().mark(function o(l){var n,i,a=arguments;return p()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return n=a.length>1&&a[1]!==void 0?a[1]:{},n.params=s()(s()({},n.params),{},{tableName:"codeList"}),i=(0,S.request)("",s()({method:"get",data:n.body||""},n||{})),_.abrupt("return",i);case 4:case"end":return _.stop()}},o)})),x.apply(this,arguments)}function J(o){return U.apply(this,arguments)}function U(){return U=r()(p()().mark(function o(l){var n,i,a,O,_=arguments;return p()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return i=_.length>1&&_[1]!==void 0?_[1]:{},a=i==null||(n=i.body)===null||n===void 0?void 0:n.objectId,i.params=s()(s()({},i.params),{},{tableName:"codeList"}),O=(0,S.request)(a||"",s()({method:a?"put":"post",data:i.body||""},i||{})),M.abrupt("return",O);case 5:case"end":return M.stop()}},o)})),U.apply(this,arguments)}function u(o){return b.apply(this,arguments)}function b(){return b=r()(p()().mark(function o(l){var n,i,a=arguments;return p()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return n=a.length>1&&a[1]!==void 0?a[1]:{},n.params=s()(s()({},n.params),{},{tableName:"codeList"}),i=(0,S.request)(n.objectId||"",s()({method:"delete",data:n.body||""},n||{})),_.abrupt("return",i);case 4:case"end":return _.stop()}},o)})),b.apply(this,arguments)}}}]);
