"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[352],{64909:function(pe,S,o){o.r(S),o.d(S,{default:function(){return q}});var Z=o(39346),d=o.n(Z),B=o(42525),I=o.n(B),L=o(9083),F=o.n(L),g=o(49188),D=o(52353),J=o(98539),O=o(80676),H=o(63287),M=o(1169),T=o(88350),K=o(80062),z=o(673),m=o(38497),X=o(80614),Y=o(69949),A=o(23086),N=o(46175),p=o(85658),G=o(25474),w=o(34892),l=o(96469),R=["cell"],V=["cell"],U=function(){var ee=(0,m.useState)(),E=F()(ee,2),i=E[0],te=E[1],oe=function(){he(),g.kJ.registerEdge("custom-edge-label",{inherit:"edge",defaultLabel:{markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}],attrs:{label:{fill:"#000",fontSize:14,textAnchor:"middle",textVerticalAnchor:"middle",pointerEvents:"none"},body:{ref:"label",fill:"#ffd591",stroke:"#ffa940",strokeWidth:2,rx:4,ry:4,refWidth:"140%",refHeight:"140%",refX:"-20%",refY:"-20%"}},position:{distance:200,options:{absoluteDistance:!0,reverseDistance:!0}}}},!0);var e=new g.kJ({container:document.getElementById("graph-container"),grid:1,autoResize:!0,width:1600,height:500,mousewheel:{enabled:!0,zoomAtMousePosition:!0,modifiers:"ctrl",minScale:.5,maxScale:3},embedding:{enabled:!0,findParent:function(n){var s=n.node,j=s.getBBox();return this.getNodes().filter(function(v){var x=v.getData();if(x&&x.parent){var y=v.getBBox();return j.isIntersectWithRect(y)}return!1})}},connecting:{connector:{name:"rounded",args:{radius:8}},anchor:"center",allowBlank:!1,allowMulti:!0,allowNode:!0,allowEdge:!0,allowPort:!0,snap:{radius:20},createEdge:function(){var n=new g.bn.kS({zIndex:9999999,attrs:{line:{stroke:"#A2B1C3",strokeWidth:2,strokeDasharray:5,style:{animation:"ant-line 30s infinite linear"}}},tools:[{name:"target-arrowhead",args:{attrs:{fill:"#f00",name:"classic",width:3,height:3}}},{name:"edge-editor"},{name:"button-remove",args:{distance:"50%",offset:{y:-20}}}]});return n.appendLabel({tools:[{name:"edge-editor"}],className:"ttttttttext",attrs:{text:{text:"Hello Label"},offset:{y:-20}}}),n},validateConnection:function(n){var s=n.targetMagnet;return console.log("targetMagnet",s),!!s}},highlighting:{magnetAdsorbed:{name:"stroke",args:{attrs:{fill:"#5F95FF",stroke:"#5F95FF"}}}}});console.log("graphIns",e);var r=e;r.use(new J.w({resizing:!0,rotating:!0})),r.use(new O.Y({rubberband:!0,showNodeSelectionBox:!0})),r.use(new H.H({enabled:!0})),r.use(new M.N({enabled:!0,global:!0})),r.use(new T.T({enabled:!0})),r.use(new K.A({enabled:!0}));var u=0;e.on("node:mousedown",function(t){var n=t.node,s=t.e;if(!n.getChildren()){var j=e.getNodes().reduce(function(v,x){var y=x.getZIndex()||0,ve=y>v?y:v;return ve},0);Date.now()-u>500&&n.setZIndex(j+1),u=Date.now()}}),e.on("edge:mouseenter",function(t){var n=t.cell,s=I()(t,R);console.log(s.e.target.tagName),s.e.target.tagName==="rect"?(console.log("22222",22222),n.removeTool("vertices")):n.addTools([{name:"vertices",args:{attrs:{fill:"#666"}}}])}),e.on("edge:mouseleave",function(t){var n=t.cell,s=I()(t,V);n.addTools([{name:"vertices",args:{attrs:{fill:"#666"}}}])});var c=new D.t({title:"\u6D41\u7A0B\u56FE",target:e,stencilGraphWidth:200,stencilGraphHeight:230,collapsable:!0,groups:[{title:"\u57FA\u7840\u6D41\u7A0B\u56FE",name:"group1"},{title:"\u7CFB\u7EDF\u8BBE\u8BA1\u56FE",name:"group2",graphHeight:250,layoutOptions:{rowHeight:70}}],layoutOptions:{columns:2,columnWidth:80,rowHeight:55}});document.getElementById("stencil").appendChild(c.container),e.bindKey(["meta+c","ctrl+c"],function(){var t=e.getSelectedCells();return t.length&&e.copy(t),!1}),e.bindKey(["meta+v","ctrl+v"],function(){if(!e.isClipboardEmpty()){var t=e.paste({offset:32});e.cleanSelection(),e.select(t)}return!1}),e.bindKey(["meta+z","ctrl+z"],function(){return console.log(e.canUndo),e.canUndo()&&e.undo(),!1}),e.bindKey(["meta+shift+z","ctrl+shift+z"],function(){return e.canRedo()&&e.redo(),!1}),e.bindKey(["meta+a","ctrl+a"],function(){var t=e.getNodes();t&&e.select(t)}),e.bindKey("delete",function(){var t=e.getSelectedCells();t.length&&e.removeCells(t)});var h={groups:{top:{position:"top",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{}}}},right:{position:"right",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{}}}},bottom:{position:"bottom",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{}}}},left:{position:"left",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]};g.kJ.registerNode("custom-rect",{inherit:"rect",width:66,height:36,attrs:{body:{strokeWidth:1,stroke:"#5F95FF",fill:"#EFF4FF",magnet:!0},text:{fontSize:12,fill:"#262626"}},ports:d()({},h)},!0),g.kJ.registerNode("custom-polygon",{inherit:"polygon",width:66,height:36,attrs:{body:{strokeWidth:1,stroke:"#5F95FF",fill:"#EFF4FF"},text:{fontSize:12,fill:"#262626"}},ports:d()(d()({},h),{},{items:[{group:"top"},{group:"bottom"},{group:"left"},{group:"right"}]})},!0),g.kJ.registerNode("custom-circle",{inherit:"circle",width:45,height:45,attrs:{body:{strokeWidth:1,stroke:"#5F95FF",fill:"#EFF4FF"},text:{fontSize:12,fill:"#262626"}},ports:d()({},h)},!0),g.kJ.registerNode("custom-image",{inherit:"rect",width:52,height:52,markup:[{tagName:"rect",selector:"body"},{tagName:"image"},{tagName:"text",selector:"label"}],attrs:{body:{stroke:"#5F95FF",fill:"#5F95FF"},image:{width:26,height:26,refX:13,refY:16},label:{refX:3,refY:2,textAnchor:"left",textVerticalAnchor:"middle",fontSize:12,fill:"#fff"}},ports:d()({},h)},!0),g.kJ.registerNode("custom-embed",{inherit:"rect",width:52,height:52,markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}],attrs:{body:{stroke:"#5F95FF",fill:"#5F95FF"},label:{refX:3,refY:2,textAnchor:"center",textVerticalAnchor:"top",fontSize:12,fill:"#fff"}},ports:d()({},h)},!0),te(e);var ie=e.createNode({shape:"custom-rect",label:"\u8282\u70B91",attrs:{body:{rx:20,ry:26}},tools:[{name:"node-editor"},{name:"button-remove",args:{x:"100%",y:0,offset:{x:0,y:0}}}]}),le=e.createNode({shape:"custom-rect",label:"\u8282\u70B92",tools:[{name:"node-editor"},{name:"button-remove",args:{x:"100%",y:0,offset:{x:0,y:0}}}]}),se=e.createNode({shape:"custom-rect",label:"\u5BB9\u5668",tools:[{name:"node-editor"},{name:"button-remove",args:{x:"100%",y:0,offset:{x:0,y:0}}}],data:{parent:!0}}),de=e.createNode({shape:"custom-rect",attrs:{body:{rx:6,ry:6}},label:"\u53EF\u9009\u8FC7\u7A0B",tools:[{name:"node-editor"},{name:"button-remove",args:{x:"100%",y:0,offset:{x:0,y:0}}}]}),ce=e.createNode({shape:"custom-polygon",attrs:{body:{refPoints:"0,10 10,0 20,10 10,20"}},label:"\u51B3\u7B56",tools:[{name:"node-editor"},{name:"button-remove",args:{x:"100%",y:0,offset:{x:0,y:0}}}]}),ge=e.createNode({shape:"custom-polygon",attrs:{body:{refPoints:"10,0 40,0 30,20 0,20"}},label:"\u6570\u636E",tools:[{name:"node-editor"},{name:"button-remove",args:{x:"100%",y:0,offset:{x:0,y:0}}}]}),fe=e.createNode({shape:"custom-circle",label:"\u8FDE\u63A5",tools:[{name:"node-editor"},{name:"button-remove",args:{x:"100%",y:0,offset:{x:0,y:0}}}]});c.load([ie,le,se,de,ce,ge,fe],"group1");var ue=[{label:"Client",image:"https://gw.alipayobjects.com/zos/bmw-prod/687b6cb9-4b97-42a6-96d0-34b3099133ac.svg"},{label:"Http",image:"https://gw.alipayobjects.com/zos/bmw-prod/dc1ced06-417d-466f-927b-b4a4d3265791.svg"},{label:"Api",image:"https://gw.alipayobjects.com/zos/bmw-prod/c55d7ae1-8d20-4585-bd8f-ca23653a4489.svg"},{label:"Sql",image:"https://gw.alipayobjects.com/zos/bmw-prod/6eb71764-18ed-4149-b868-53ad1542c405.svg"},{label:"Clound",image:"https://gw.alipayobjects.com/zos/bmw-prod/c36fe7cb-dc24-4854-aeb5-88d8dc36d52e.svg"},{label:"Mq",image:"https://gw.alipayobjects.com/zos/bmw-prod/2010ac9f-40e7-49d4-8c4a-4fcf2f83033b.svg"}],me=ue.map(function(t){return e.createNode({shape:"custom-image",label:t.label,attrs:{image:{"xlink:href":t.image}}})});c.load(me,"group2");function he(){var t=document.getElementById("container"),n=document.createElement("div");n.id="stencil";var s=document.createElement("div");s.id="graph-container",t.appendChild(n),t.appendChild(s),(0,z.insertCss)(`
    #container {
      border: 1px solid #dfe3e8;
      display: flex;
      width: 100%;
      height: 500px;
    }

    
    #stencil {
      width: 180px;
      height: 100%;
      position: relative;
      flex-basic: 180px;
      flex-shrink: 0;
      border-right: 1px solid #dfe3e8;
    }
    .x6-widget-stencil  {
      background-color: #fff;
    }
    .x6-widget-stencil-title {
      background-color: #fff;
    }
    .x6-widget-stencil-group-title {
      background-color: #fff !important;
    }
    .x6-widget-transform {
      margin: -1px 0 0 -1px;
      padding: 0px;
      border: 1px solid #239edd;
    }
    .x6-widget-transform > div {
      border: 1px solid #239edd;
    }
    .x6-widget-transform > div:hover {
      background-color: #3dafe4;
    }
    .x6-widget-transform-active-handle {
      background-color: #3dafe4;
    }
    .x6-widget-transform-resize {
      border-radius: 0;
    }
    .x6-widget-selection-inner {
      border: 1px solid #239edd;
    }
    .x6-widget-selection-box {
      opacity: 0;
    }
  `),(0,z.insertCss)(`
  @keyframes ant-line {
    to {
        stroke-dashoffset: -1000
    }
  }
`)}},ne=(0,m.useState)({}),W=F()(ne,2),a=W[0],b=W[1],re=(0,m.useState)([]),P=F()(re,2),k=P[0],ae=P[1],C=function(){w.d.k.getCodeListData("",{tableName:"x6List"}).then(function(e){ae(e.results||[])})};return(0,m.useEffect)(function(){C(),oe()},[]),(0,m.useEffect)(function(){i==null||i.fromJSON(JSON.parse(a.codeInfo||"{}"))},[a.objectId]),(0,l.jsxs)("div",{children:[(0,l.jsxs)(X.Z,{children:[(0,l.jsx)(Y.Z,{style:{width:300},value:a==null?void 0:a.name,onChange:function(e){var r=e.target;console.log("v11111",r.value),b(d()(d()({},a),{},{name:r.value}))}}),(0,l.jsx)(A.Z,{style:{width:300},value:a.objectId,onChange:function(e){console.log("v22222",e),b(k.find(function(r){return r.objectId===e}))},children:k.map(function(f){return(0,l.jsx)(A.Z.Option,{children:f.name},f.objectId)})}),(0,l.jsx)(N.ZP,{type:"primary",onClick:function(){console.log(">>>>>>>>>",i==null?void 0:i.toJSON());var e=(i==null?void 0:i.toJSON())||{};if(!a.name){p.ZP.warning("\u6A21\u578B\u540D\u79F0\u5FC5\u586B\u5594\uFF01");return}w.d.k.addCodeListData("",{tableName:"x6List",body:d()(d()({},a),{},{createdAt:void 0,codeInfo:JSON.stringify(e)})}).then(function(r){p.ZP.success("\u64CD\u4F5C\u6210\u529F\uFF01"),b(a),C()})},children:"\u4FDD\u5B58"}),(0,l.jsx)(N.ZP,{type:"primary",danger:!0,onClick:function(){console.log("x6ActiveInfo",a);var e=k.find(function(r){return r.objectId===a.objectId});G.Z.confirm({title:"\u5220\u9664\u63D0\u793A",content:"\u60A8\u786E\u8BA4\u8981\u5220\u9664".concat(e.name,"\u5417?"),onOk:function(){console.log("x6ActiveInfo",a),w.d.k.deleteCodeListData("",{tableName:"x6List",objectId:a.objectId||""}).then(function(u){b({}),p.ZP.success("\u5220\u9664\u6210\u529F\uFF01"),C()}).catch(function(u){var c;p.ZP.warning((u==null||(c=u.response)===null||c===void 0||(c=c.data)===null||c===void 0?void 0:c.error)||"")})}})},children:"\u5220\u9664"}),(0,l.jsx)(N.ZP,{type:"primary",ghost:!0,onClick:function(){console.log("graph",i);var e=new g.NB({shape:"rect",size:{width:100,height:60},markup:[{tagName:"rect",selector:"body1"},{tagName:"text",selector:"label"}],x:100,y:40,width:100,attrs:{body1:{stroke:"#0f0",fill:"#0ff",width:100,height:50,refHeight:80},label:{text:"rectcccccccccc",fill:"#f00"}}});i==null||i.addNode(e)},children:"add cell"})]}),(0,l.jsx)("div",{id:"container"})]})},$=U,Q=function(){return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)($,{})})},q=Q}}]);
